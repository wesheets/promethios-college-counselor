{% extends "layout.html" %}

{% block title %}College Counselor - Report{% endblock %}

{% block content %}
<div class="report-section">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1 class="page-title">Comprehensive Report</h1>
        <p class="lead">A detailed analysis of your college recommendations with complete decision trails.</p>
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h3 class="mb-0">Student Profile Summary</h3>
              <button class="btn btn-outline-primary btn-sm" id="printReportBtn">
                <i class="fas fa-print me-1"></i> Print Report
              </button>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <table class="table table-sm">
                  <tr>
                    <th>Name:</th>
                    <td id="studentName">John Smith</td>
                  </tr>
                  <tr>
                    <th>GPA:</th>
                    <td id="studentGPA">3.8</td>
                  </tr>
                  <tr>
                    <th>Intended Majors:</th>
                    <td id="studentMajors">Computer Science, Mathematics</td>
                  </tr>
                </table>
              </div>
              <div class="col-md-6">
                <table class="table table-sm">
                  <tr>
                    <th>Location Preference:</th>
                    <td id="studentLocation">California</td>
                  </tr>
                  <tr>
                    <th>Budget:</th>
                    <td id="studentBudget">$50,000 per year</td>
                  </tr>
                  <tr>
                    <th>Report Generated:</th>
                    <td id="reportDate">May 17, 2025</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            <h3 class="mb-0">Emotional State Analysis</h3>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-4">
                <div class="card">
                  <div class="card-body text-center">
                    <h5>Current Emotional State</h5>
                    <div id="emotionIndicator" class="emotion-indicator">
                      <i class="fas fa-smile emotion-icon"></i>
                    </div>
                    <p id="emotionLabel" class="mt-2">Balanced</p>
                  </div>
                </div>
              </div>
              <div class="col-md-8">
                <div class="card">
                  <div class="card-body">
                    <h5>Analysis</h5>
                    <div class="row">
                      <div class="col-md-4">
                        <label>Sentiment:</label>
                        <div class="progress">
                          <div id="sentimentProgress" class="progress-bar bg-success" role="progressbar" style="width: 75%;" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">75%</div>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <label>Certainty:</label>
                        <div class="progress">
                          <div id="certaintyProgress" class="progress-bar bg-info" role="progressbar" style="width: 70%;" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100">70%</div>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <label>Calmness:</label>
                        <div class="progress">
                          <div id="calmnessProgress" class="progress-bar bg-primary" role="progressbar" style="width: 80%;" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100">80%</div>
                        </div>
                      </div>
                    </div>
                    <div class="mt-3">
                      <p id="emotionSummary">Your emotional state appears balanced for decision-making. Based on your recent journal entries, you seem ready to make informed college decisions.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            <h3 class="mb-0">Recommendation Summary</h3>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>College</th>
                    <th>Category</th>
                    <th>Trust Score</th>
                    <th>Academic Match</th>
                    <th>Budget Match</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="recommendationSummaryTable">
                  <!-- Recommendations will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            <h3 class="mb-0">Decision Trail</h3>
          </div>
          <div class="card-body">
            <div class="timeline">
              <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                  <h4 class="timeline-title">Profile Created</h4>
                  <p class="timeline-date">May 5, 2025</p>
                  <p>Initial student profile created with GPA 3.8, intended majors in Computer Science and Mathematics, and location preference for California.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                  <h4 class="timeline-title">Journal Entry Analysis</h4>
                  <p class="timeline-date">May 10, 2025</p>
                  <p>Journal entry indicated anxiety about college applications. Emotional state analysis showed elevated stress levels.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                  <h4 class="timeline-title">Initial Recommendations Generated</h4>
                  <p class="timeline-date">May 12, 2025</p>
                  <p>Initial set of 10 college recommendations generated based on academic profile and preferences.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                  <h4 class="timeline-title">Manual Override Applied</h4>
                  <p class="timeline-date">May 15, 2025</p>
                  <p>Manual override applied to include "Tech Institute" in recommendations. Justification: "They have a special program in robotics that matches my interests."</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                  <h4 class="timeline-title">Final Recommendations Generated</h4>
                  <p class="timeline-date">May 17, 2025</p>
                  <p>Final set of recommendations generated with updated emotional state analysis showing balanced decision-making capacity.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            <h3 class="mb-0">Override Log</h3>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>College</th>
                    <th>Action</th>
                    <th>Justification</th>
                    <th>Trust Score Impact</th>
                  </tr>
                </thead>
                <tbody id="overrideLogTable">
                  <tr>
                    <td>May 15, 2025</td>
                    <td>Tech Institute</td>
                    <td><span class="badge bg-success">Include</span></td>
                    <td>They have a special program in robotics that matches my interests.</td>
                    <td>+15 points</td>
                  </tr>
                  <tr>
                    <td>May 16, 2025</td>
                    <td>City College</td>
                    <td><span class="badge bg-danger">Exclude</span></td>
                    <td>After visiting the campus, I didn't feel it was a good cultural fit for me.</td>
                    <td>N/A</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            <h3 class="mb-0">Next Steps</h3>
          </div>
          <div class="card-body">
            <ol class="next-steps-list">
              <li>
                <h5>Research Specific Programs</h5>
                <p>Look into the specific programs at your top recommended colleges to ensure they align with your academic goals.</p>
              </li>
              <li>
                <h5>Plan Campus Visits</h5>
                <p>Schedule visits to your top choices to get a feel for the campus environment and culture.</p>
              </li>
              <li>
                <h5>Prepare Application Materials</h5>
                <p>Start gathering materials for applications, including transcripts, recommendation letters, and personal statements.</p>
              </li>
              <li>
                <h5>Review Financial Aid Options</h5>
                <p>Research scholarships and financial aid opportunities at your recommended colleges.</p>
              </li>
            </ol>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Sample recommendation summary data
    const recommendations = [
      {
        college: "Ivy University",
        category: "Reach",
        trustScore: 65,
        academicMatch: 60,
        budgetMatch: 50,
        status: "Recommended"
      },
      {
        college: "State University",
        category: "Target",
        trustScore: 85,
        academicMatch: 80,
        budgetMatch: 90,
        status: "Recommended"
      },
      {
        college: "Liberal Arts College",
        category: "Target",
        trustScore: 70,
        academicMatch: 75,
        budgetMatch: 60,
        status: "Recommended"
      },
      {
        college: "Tech Institute",
        category: "Reach",
        trustScore: 78,
        academicMatch: 75,
        budgetMatch: 70,
        status: "Recommended (Override)"
      },
      {
        college: "City College",
        category: "Safety",
        trustScore: 90,
        academicMatch: 95,
        budgetMatch: 85,
        status: "Excluded (Override)"
      }
    ];
    
    // Populate recommendation summary table
    const recommendationSummaryTable = document.getElementById('recommendationSummaryTable');
    recommendations.forEach(rec => {
      const row = document.createElement('tr');
      
      // Add college name
      const collegeCell = document.createElement('td');
      collegeCell.textContent = rec.college;
      row.appendChild(collegeCell);
      
      // Add category with badge
      const categoryCell = document.createElement('td');
      const categoryBadge = document.createElement('span');
      categoryBadge.textContent = rec.category;
      
      if (rec.category === 'Reach') {
        categoryBadge.className = 'badge bg-danger';
      } else if (rec.category === 'Target') {
        categoryBadge.className = 'badge bg-primary';
      } else if (rec.category === 'Safety') {
        categoryBadge.className = 'badge bg-success';
      }
      
      categoryCell.appendChild(categoryBadge);
      row.appendChild(categoryCell);
      
      // Add trust score
      const trustScoreCell = document.createElement('td');
      trustScoreCell.textContent = rec.trustScore;
      row.appendChild(trustScoreCell);
      
      // Add academic match
      const academicMatchCell = document.createElement('td');
      academicMatchCell.textContent = rec.academicMatch;
      row.appendChild(academicMatchCell);
      
      // Add budget match
      const budgetMatchCell = document.createElement('td');
      budgetMatchCell.textContent = rec.budgetMatch;
      row.appendChild(budgetMatchCell);
      
      // Add status
      const statusCell = document.createElement('td');
      const statusText = document.createElement('span');
      statusText.textContent = rec.status;
      
      if (rec.status.includes('Override')) {
        statusText.className = 'text-primary fw-bold';
      } else if (rec.status.includes('Excluded')) {
        statusText.className = 'text-danger';
      }
      
      statusCell.appendChild(statusText);
      row.appendChild(statusCell);
      
      recommendationSummaryTable.appendChild(row);
    });
    
    // Handle print button
    const printReportBtn = document.getElementById('printReportBtn');
    printReportBtn.addEventListener('click', function() {
      window.print();
    });
  });
</script>

<style>
  /* Timeline styles */
  .timeline {
    position: relative;
    padding-left: 30px;
  }
  
  .timeline::before {
    content: '';
    position: absolute;
    top: 0;
    left: 15px;
    height: 100%;
    width: 2px;
    background-color: #dee2e6;
  }
  
  .timeline-item {
    position: relative;
    margin-bottom: 30px;
  }
  
  .timeline-marker {
    position: absolute;
    left: -30px;
    width: 15px;
    height: 15px;
    border-radius: 50%;
    background-color: #007bff;
    top: 5px;
  }
  
  .timeline-content {
    padding-bottom: 10px;
  }
  
  .timeline-title {
    margin-bottom: 5px;
  }
  
  .timeline-date {
    color: #6c757d;
    font-size: 0.9rem;
    margin-bottom: 10px;
  }
  
  /* Emotion indicator styles */
  .emotion-indicator {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    background-color: #f8f9fa;
    border: 2px solid #dee2e6;
  }
  
  .emotion-icon {
    font-size: 40px;
    color: #28a745;
  }
  
  /* Print styles */
  @media print {
    .navbar, .footer, #printReportBtn {
      display: none !important;
    }
    
    .card {
      border: 1px solid #dee2e6 !important;
      break-inside: avoid;
    }
    
    .page-title {
      text-align: center;
      margin-bottom: 20px;
    }
  }
</style>
{% endblock %}
